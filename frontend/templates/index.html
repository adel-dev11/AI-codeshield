<!-- templates/index.html -->
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LicenseGuard - مدقق تراخيص المشاريع</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="{{ url_for('static', filename='style.css') }}" rel="stylesheet">
</head>
<body class="bg-light">
    <div class="container py-5">
        <div class="text-center mb-5">
            <h1 class="display-4 text-primary">LicenseGuard</h1>
            <p class="lead">مدقق تراخيص المشاريع بالذكاء الاصطناعي - عربي 100%</p>
        </div>

        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            {% for category, message in messages %}
              <div class="alert alert-{{ 'danger' if category=='error' else 'success' if category=='success' else 'warning' }} text-center">
                {{ message }}
              </div>
            {% endfor %}
          {% endif %}
        {% endwith %}

        <div class="row g-4">
            <!-- فحص يدوي -->
            <div class="col-md-6">
                <div class="card h-100 shadow">
                    <div class="card-body">
                        <h5>فحص ترخيص يدويًا</h5>
                        <form method="POST">
                            <input type="text" name="manual_license" class="form-control mb-3" placeholder="مثال: MIT أو GPL-3.0-only" required>
                            <button type="submit" class="btn btn-primary w-100">فحص الآن</button>
                        </form>
                    </div>
                </div>
            </div>

            <!-- رفع ملف -->
            <div class="col-md-6">
                <div class="card h-100 shadow">
                    <div class="card-body">
                        <h5>رفع ملف المشروع</h5>
                        <form method="POST" enctype="multipart/form-data">
                            <input type="file" name="file" class="form-control" accept=".txt,.md,.json,.xml,.yml,.yaml" required>
                            <small class="text-muted">يدعم: LICENSE, package.json, pom.xml, requirements.txt, إلخ</small>
                            <button type="submit" class="btn btn-success w-100 mt-3">تحليل الملف</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- النتايج -->
        {% if results %}
<h3 class="mt-4">نتائج التحليل</h3>
<table class="table table-bordered mt-2">
    <thead class="table-dark">
        <tr>
            <th>اسم الترخيص</th>
            <th>الحالة</th>
            <th>الثقة</th>
            <th>ملاحظة</th>
            <th>البديل الآمن المقترح</th>

        </tr>
    </thead>
    <tbody>
        {% for r in results %}
        <tr>
            <td>{{ r['الترخيص'] }}</td>
            <td>{{ r['الحالة'] }}</td>
            <td>{{ r['الثقة'] }}</td>
            <td>{{ r['ملاحظة'] }}</td>
            <td>{{ results['البديل الآمن'] | safe }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endif %}
{% if report_path %}
    <div class="alert alert-info mt-4">
        <strong>تم إنشاء التقرير!</strong><br>
        <a href="{{ url_for('download_file', filename=report_path.split('/')[-1]) }}" class="btn btn-success btn-sm mt-2">
            تحميل التقرير (Excel)
        </a>
    </div>
{% endif %}
    </div>
</body>
</html>
